#!/usr/bin/env python3

from wots import *
from speclib import *
from sys import exit

m1: digest_t = bytes.from_hex("b8cdb147973dea2ec70aa59ce71ec6d88277761d717221580eb847abd0a4e6a9")
seed1: seed_t = bytes.from_hex("c36ca7f20260dd3f0cc08133f7d86ee682579f61263b2e8d43b4b9630aa53028")
adr1: address_t = vlarray([uint32(0x7e7c37a3), uint32(0x0a43c868), uint32(0xfc72f92b), uint32(0x1644edcd),
                           uint32(0x8589250a), uint32(0x00000042), uint32(0x00000001), uint32(0x00000001)], uint32_t)
adr1p: address_t = vlarray([uint32(0x7e7c37a3), uint32(0x0a43c868), uint32(0xfc72f92b), uint32(0x1644edcd),
                            uint32(0x8589250a), uint32(0x00000042), uint32(0x0000000e), uint32(0x00000001)], uint32_t)
pk1: pk_t = vlarray([bytes.from_hex("156c09cec70795d96f1dff349f976bfc1bf9ae165eff96f47af28aed09335f7f"), bytes.from_hex("9c63b000f5e0a61faebd9219b7407e61d72c6ff53e550b4aff6be83822473e92"), bytes.from_hex("247d93a0c5a5f43f4c42d818af51f3ba80cb40afb35366b741775df934030005"), bytes.from_hex("fcb5315e681227eeb326eb3242df7496013d19ec5af27187b1c8b896c0cb97d2"), bytes.from_hex("0445d403d09f4293b8e0a15751cdbdb7cfd33885caf7a17ae81147bdb9f987c7"), bytes.from_hex("53ab5fb991656fccc6fba8024140f62d5d59251b78a35536b86e570ca4893736"), bytes.from_hex("18d6ec9309c32a0e37acdd60774ecb8b5cc07e69bbc8ec075697143472fb563c"), bytes.from_hex("5dedd5ef7fef2deb0e15c04e01404cdd729355721be62f995e78455144b7120a"), bytes.from_hex("4b37563dedf25fc01f40dae66d578959af08e1724912eb914f718ab7e11641f3"), bytes.from_hex("97799f82dfc77d993302234f3f241cf5e372a254dd84bae942fb6f4413d50735"), bytes.from_hex("5b639e1b9c4374f2da7d6a3c7034b7c1c4a0eac3f2157e4ce4fea9575a8275ce"), bytes.from_hex("958229b818581a1084c4462b17a47369405b5d5db56be1d53f1df8c1e69f2740"), bytes.from_hex("b15ce6028f38f4123b031fa2cf2643887bd8f743c96e34a932080c94f59981c1"), bytes.from_hex("021eddf56359d5d2089e066e4718a5a699e14e15686b1dbd2614ca07693af1fb"), bytes.from_hex("63dfe809cbe75c1fee78e979e6b00910180ad7e5c6ef9fe49d2f0dedc403c7d4"), bytes.from_hex("eb4c01b93ebf71cffb42c6cc2f81c2016d000b94cdd8c174a35a40c307fbfa5d"), bytes.from_hex("ac9fe7df3d2e2e48fa3a3b7973ae502eae4f50850e885bc653d8b985b818aa8d"), bytes.from_hex("b2d6c01cb82d132a59cdf5bee2b1e00752e38ace81a804a713cf5cfa11cbf892"), bytes.from_hex("7e1c8fab440db08e4525d9091db61ad56e63d2a1f5985e8535d04dfafe5f4b84"), bytes.from_hex("212eb9a212151e231cd3294037f025f510b20b403099e0f949033e78a9bb4ee4"), bytes.from_hex("45623bfa4d4e5246ad01c9118ba6f2129ee746e771aa706e3bcd9b3700832042"), bytes.from_hex("d7d6bb780408be8a1987295aab1e87ec61b15d8a0fbe89102b083fed78a8f4dc"), bytes.from_hex("d92d3c001d70fcf448e8095d9ae5b59b4ebc4de1d81cd7f9e49f74b5916e0eb2"), bytes.from_hex("2703da0174b7a1c63ec776b7761e55713b8ea8038fba5f12a0cb7be73701c825"), bytes.from_hex("d9c36c65a9b31666b1094b7711db2732cdb7286f28c72bc201fa40468889f991"), bytes.from_hex("4b1d86ae0e3206df92174fe06c7f90dabe1906f52314272ee53d327b8e5d02dc"), bytes.from_hex("39e3a8dd81f40034c49d2f4d208047ec6ecb6d7f1114fa814f54f365f26e350b"), bytes.from_hex("7aef634b169d6817c3ef7a322d9882fd67d2a5b69a2e8c6e5fb7bc269e092ea2"), bytes.from_hex("462df9ea9f49891fb22cd0be870335f1730f5d11bda6d9c2adc2d6a9be4db015"), bytes.from_hex("210e6f61e30d2ed986d7ced336ae1a06994110037186ce8a8a29235f91e080de"), bytes.from_hex("1434a617eea725302996b1bdaf63e68079315d98cd4f08b010d0c62903b3f023"), bytes.from_hex("7d5a86f3913e89c436de0a3312f4e6afcc40ca1aebc2c9b9be19d87faf3e94fb"), bytes.from_hex("293616b81027cf75838086792131d78ada949d47066e34a2e89e40450a135f5a"), bytes.from_hex("a3c9cb09f63ce7f5fea007784fe07bd9b130153c73fb189704872e65863d29a5"), bytes.from_hex("c975e749918650dee2446ae0c46b57ddaf90a616de7dd1d372096b5e885991a7"), bytes.from_hex("10d9f7c59b28977ea596333cfd1483c5a5ac8d70da35a19f0c04e6b6ad72ca32"), bytes.from_hex("5e439927bb3c8d837b9f45455e4621a8d3825d0135273dbc6a8a185d91b10ac5"), bytes.from_hex("6be8ac570333113cb15e5fdf830252d1dbf24d2380d7263246666dff0408f072"), bytes.from_hex("a6c798a4f19d5cdb13d8fe6fdfb6c3a8c8a6bb30e4f5fb74737a110fd36a5024"), bytes.from_hex("ce2bb5c5982522bc9d52a89f3eba10352f3fc79aa5bcabc2ce6f84b2f005665b"), bytes.from_hex("695ae07c708141c6d0e71c5c3ff0b6a2466fbc3b99eb277e436a7654ffb09fdc"), bytes.from_hex("51f098c9c54d5fce186723d8447773e6f7e8f0a871ebfdf005fcbd7e46bee0d5"), bytes.from_hex("e18e6a43952b21f13997711c8b5cd7b328a2b2b5cc106feb46e308214e0c7083"), bytes.from_hex("aec489e6b1374eedce74c3188297a7eff627466608b2498f36e92f087aaca8ea"), bytes.from_hex("1e814b04f037129d584e51a3306e20cd3b1941485c17f3a6ceec7ef56f901894"), bytes.from_hex("f3b59fb4620e4e1ab0bb13142e0d0ee18df56f5cd5f865597d6d42a01b82f58d"), bytes.from_hex("6849b7c12646126b62ab5e92677ea46dd381a2148d4abed5290c53a9ecf11d9f"), bytes.from_hex("1932b18d6ff132b4d37a91b9587da92eacc229a84650f8e15c876caa33c52f27"), bytes.from_hex("15c7159941e110ea8bda1297a33ca29ac43825d51a1cda11f654678461f8bff1"), bytes.from_hex("2d688ae625925af6e82de87f52ff15434475db2b72104bc4a70f4cc0a0e8f3ae"), bytes.from_hex("f7e70c9cb06e00aed29b763136edadfd5153100b42a433181c9df5287e7e05bc"), bytes.from_hex("8398a307993c049327aa743856c33afb06c6820ef5edbe5dfcee2161a7e549a0"), bytes.from_hex("2acdf74bd6eb0b960c0ff1971228b33abe58685e44a82600f99c10a5abe51da1"), bytes.from_hex("94c9bfe947e29f60fb7ea980db33241d8d631390c812477ffdb55b1a45974fbb"), bytes.from_hex("895c9234d3c22b6c758875b2f6531abd282107e403d19d5d206e4a542d737ef8"), bytes.from_hex("70bd408a73993c823b368a0a879363cba1b959db7237135fedda5f276cf19a68"), bytes.from_hex("ddead01689180611f6ff96808746173f4ca989ebfd238708d2e753b9dcf001a1"), bytes.from_hex("09d2ba5e290966bee8c4a3ed31da09c15c9473e1e91e1295a6ff436938bd9df2"), bytes.from_hex("ba7a53f4949bc98cf45967b46acfdbf1e89b8a1a18b2668345d45abb570a8168"), bytes.from_hex("24a6171b2830f685d561c4b31a3d0995d8cc8630e5c8f198c95cff64540604a5"), bytes.from_hex("3b4ad75b1c52eb26033f3a195255935f2280e8dd259006cb5bd9aae1f4bb8de2"), bytes.from_hex("ef91e29b73cea595daa70d33f32b2ebfae9ba5da8fbf9676d184bff6d8234109"), bytes.from_hex("7c6af998a67bc09c9c2f3cf2151d58156fe2c379ae30b096395e29745c409d76"), bytes.from_hex("718ff587af819ef90ef44fa111212a1b221e853e91861d7073c259db667cb1b8"), bytes.from_hex("f9d01dbf71a2119650c18c2626620ea4a1cb178a666f464bb7024464f7b4c34f"), bytes.from_hex("520c22176c61dc392e0b9f47c39b5e9c695613e3dda94e3bb1be7105fdeacdad"), bytes.from_hex("919ec89c5153601e669a92d0e62672e643113dd7cf5ff411ab2a880b73c077d1")])
sig1: sig_t = vlarray([bytes.from_hex("8b2d1ba56f629f9d35e85a18de3cbcf2152afa8cb3230fa009b1da466fb87976"), bytes.from_hex("0fc18b61c4f4b8fb369e933d1df4bb4f81628aa97e80fbef6fd84934e00e33e8"), bytes.from_hex("ab61e7926bcc9231c7a6d78b753ee0a337a9fef93ff9aa134ab87feefcdc0536"), bytes.from_hex("3ca08e9a428da3d66fabf1112b268d4ed100a0a95899a322ff68566579637c9a"), bytes.from_hex("ac357e7a8531a8cdec101f841d0eb1ec33ec826687fa1aaceb3838f99d99e8e2"), bytes.from_hex("a120494f2f4501557a9c0ceae3463f67d15b0287d01a715d24395ba60e7edd13"), bytes.from_hex("2b2e483dea637e790fb37a8b8a951c0060a892b75617f36d678393b4ac43f536"), bytes.from_hex("7be6cc03ae9a9c5f0a8063289598e101688ae8885ffa9e5bf79c62d03b9e91cb"), bytes.from_hex("dcd99338d98eac7fcc2dc2887a0b988c607996ef4254057e797b1e602bdb65dc"), bytes.from_hex("e4532770e2782742b0374d05a2afec6de8b83bd4df90de7c8e3c5e194224c250"), bytes.from_hex("41d9a0fc0a3909a2b801ac8a5172fe8167a2d52920f04ab5b1e01337e91215bc"), bytes.from_hex("80238ff9d7ca1e453abe6fe616a617f0f38921758b2c8fd446486379bcb0c0f9"), bytes.from_hex("33b8e321ba577cb9e39571844cf3c613f5411390cf675c0dee6878a3bc0e51b1"), bytes.from_hex("ab5e80c867b26dcabf0930843d89ae5e099a0801e9018e6da13360f9460a331e"), bytes.from_hex("5e1bb0cf4631200a92deccb0834810dd4b7cb735b7c85f69e0ba2a2f83ee0722"), bytes.from_hex("d80af9a7604d33f8ae44b8cbd33b8ad7170d09e27c43bf5a3462daa539b3b3f2"), bytes.from_hex("9ac69ba76abcf06afdcc604fc216cd7d1eb57b8c54ad4f0a250304ab69a000a5"), bytes.from_hex("19462ec163d9d2817f2020e55e0a364ac1b6875e2c38cee18ffda159ab9846fc"), bytes.from_hex("d171302d508161d8f950e3df69551ae1fe63eea54319755f061f33290c7cec07"), bytes.from_hex("9277fb4eb088d859aaa35fcb8719e8ca2d9e382deca462bf761c122bd6510b9c"), bytes.from_hex("9040689f685fe81436fe4098dde37b564ceabbe5ee83f46644a9d3881265b03a"), bytes.from_hex("57d63468da5cf2b45bdc4b0fac80d07de21b306a038404568ae2ba72a2e3aa59"), bytes.from_hex("64db0c4b3c883f4228139e208a6ac66234dfa6cd267282c5a73cba505c9bf049"), bytes.from_hex("0efbcecbd1ce456107db7b34da57a319f6b62fd5427f70ca16eb3dff7d0b0ea6"), bytes.from_hex("d70d88107bf780581e48f697f77a5a488dea59d1aa9e1e93ff7696f3f286e2c5"), bytes.from_hex("f7d23795f9f92619b1c2bc7afdf99723b3320df739d8631f3419f4182a5d42b8"), bytes.from_hex("2bde536c75c660e06dbe45b3979dc78899de7a06d7ca51db1b8211b99d6f5a48"), bytes.from_hex("cd924db3aa2b9130f6529b343c577e9ff2a152daae57588369d8793395c594f1"), bytes.from_hex("1b0ac8406fa32bc89ea8f6ad411043d235a28312a1272d9064a5f4fc2ef74270"), bytes.from_hex("af84b34a58e5a772905d4b603703e608016393bcf504e516a14e1a8438e38521"), bytes.from_hex("7c690bccf86aa60f0ec12ff98d9f33cf84aaa485dde50f95c0b8eca944675ed0"), bytes.from_hex("f60db4cfb9d96f2bc30748b8da3ed32186fc85c6de969e355c9f769c982c1df8"), bytes.from_hex("111fcd976a051a711ec787e1237b762f30d05c3eb0bc0cadd9079892655e3d59"), bytes.from_hex("2e6e1e46adff0d326631f28261685fa866da08b6a69884cdbc4d69ef3908cf72"), bytes.from_hex("af12994b8b949e6d49b9562938224dc38054b6c120196b201b800ad2de3f0d1a"), bytes.from_hex("9f0eb9a900f9d11791193987405d972880d42c4cce7929b787206544a020e3c4"), bytes.from_hex("331c05bab3c4cd0a574430f8494bdcaadfc6e09a25f9f3ddec919dc79c4fd3fb"), bytes.from_hex("3991201615cc7a8ee61fbed1ff1352da6d0f33ac492cd41ea862e24c2aef8458"), bytes.from_hex("1c09f5a72690044fba829dae248b4ee8a7e8eaddd70d6afe3503efaaf230dc88"), bytes.from_hex("1393f8d15434f519aae8971c09ed4652db481cbc9722356c84470900057d1c2d"), bytes.from_hex("4164ff60cef54b3efde23a3452a281ea7bb7710c9fd643c26af8bb63c938d854"), bytes.from_hex("0c041a1a3626d396c4f2635e996f115e203aeb36ef9ca98432fb469bc3d66881"), bytes.from_hex("6d518a067d823ffbeb9afbc468614d4d3c31dca6dc9e49846aae442b889ed6a9"), bytes.from_hex("83c76ecb1f2b51aeb66eaa43a924685862163ef32cb5796611d7662ddef02797"), bytes.from_hex("a0701425b6edb12f6e9032957610d19b7ac94fe4ddf4e3fd8e50d70abcb8bd15"), bytes.from_hex("545d929aa48fd262dc78af1b8da1b5d6d0180982c1ab83d0206cc447b6da310d"), bytes.from_hex("5b6871171c6ffbd3e09c6b14a75633775a8efe4599a1ef92020481ff7ceba583"), bytes.from_hex("820e20197cdf3b244c703e0eb4829392fa6e66a98db01a10cfb1d0aef9985a7d"), bytes.from_hex("7acc78611085b6c3e30f1c7891539ec8d33f63382067f1c5a9286031893b0a1c"), bytes.from_hex("ea0e8cfacc5ab3f301609f41d8a1b178c31de44d0953cc4592d40d4ae6a3174e"), bytes.from_hex("b7185545a6da539d380e24896f171aee1b244150db005912b0700f04eb719960"), bytes.from_hex("5967b2165be545f444d5b4fe71474b1bd176c6c58a6748038db73863f2b9bb62"), bytes.from_hex("5c6b73bcbd2985e7e477c29cd875717b81fa4c426e628e0af5fb475767c20457"), bytes.from_hex("e2fd2925d3497ebf3f3c63406e70f3252756bed9754b5f08de933cd98eb9bf7f"), bytes.from_hex("ed5816a5279b5f5545eb5a29bca497fbba7f7aba9f16aaa9892c8fe2c284ca5a"), bytes.from_hex("b3e2965bb51a4405ec85aeae7ef5a94d30972b30488d659efee297bcf48c63d3"), bytes.from_hex("edf326393e791cb58c8cd9230c0323d5f7c03db61f619266d5e55b7af25ee72d"), bytes.from_hex("d437b3bf35ffcf5c8f80b7a569a57e6cfaa2c895dc840e0590e74109d79e2b0b"), bytes.from_hex("a9dcf78d6c38d7f657d7ba0d7ac79663e2495e9e839fbc00759cefd5bca7909f"), bytes.from_hex("0b7e366f79cd02b6b2274936610307605eb0d807d8011f1207d048f87c6408a8"), bytes.from_hex("50f98fae5ae60c1e769649d9059a6b932dc401c4f387826b763bc408226932d2"), bytes.from_hex("329b85202762c8ddf1364a8d6f06028fd5a69d0cd98fcb6d8a32249562574b98"), bytes.from_hex("99a347fd50fbf9ff798d4a0b81d028e44119771b5c468680ae2005fc9e33baa6"), bytes.from_hex("be1646b3d45bce0d428ede87fb4d02d0c324eee64b97ff8029aa8a9e3c9827c8"), bytes.from_hex("67f61c1d28eba92a1ffcd7d666ac0f696ee1f37c085edb0a073bfa23a533eaef"), bytes.from_hex("04da3b5a97cbca9c51e21ef1cf41e1911e75b4e51420e3763c9168781c326333"), bytes.from_hex("38afda61ee2fac89cddb7439e286ade37a4241077e5ea817d9b8ec3d831ba518")])


def test_wots(m: digest_t, pk: pk_t, sig: sig_t, adr: address_t, seed: seed_t):
    pk2, adr = wots_verify(pk, m, sig, adr, seed)
    verified = True
    if len(pk) != len(pk2):
        print("pk2 has wrong length")
        verified = False
    if verified and adr1p == adr:
        print("adr is wrong after verification")
        verified = False
    if verified:
        # for (k1, k2) in zip(pk, pk2):
        #     if k1 != k2:
        if pk1 != pk2:
            print("pks aren't equal: got " + str(pk1) + " expected " + str(pk2))
            verified = False
            # break
    if verified:
        print("Signature verified")
    else:
        print("Verification error :(")
        exit(1)


def main():
    test_wots(m1, pk1, sig1, adr1, seed1)


if __name__ == "__main__":
    main()
